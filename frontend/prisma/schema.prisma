generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                    String        @id @default(uuid())
  email                 String        @unique
  name                  String
  password              String
  emailVerified         Boolean       @default(false)
  resumeFileName        String?
  resumeData            Bytes?
  resumeMimeType        String?
  resumeUploadedAt      DateTime?
  createdAt             DateTime      @default(now())
  updatedAt             DateTime      @updatedAt
  coldEmailData         Bytes?
  coldEmailFileName     String?
  coldEmailMimeType     String?
  coldEmailUploadedAt   DateTime?
  coverLetterData       Bytes?
  coverLetterFileName   String?
  coverLetterMimeType   String?
  coverLetterUploadedAt DateTime?
  credits               Int           @default(5)
  passwordResetToken    String?
  passwordResetExpires  DateTime?     @db.Timestamp(6)
  generations           generations[]
  profile               UserProfile?

  @@map("users")
}

model UserProfile {
  id                   String   @id @default(uuid())
  userId               String   @unique
  phoneNumber          String?
  country              String?
  location             String?
  linkedinUrl          String?
  portfolioUrl         String?
  githubUrl            String?
  currentJobTitle      String?
  yearsOfExperience    Float?
  professionalSummary  String?
  highestDegree        String?
  fieldOfStudy         String?
  university           String?
  graduationYear       Int?
  workExperience       String?
  technicalSkills      String?
  softSkills           String?
  certifications       String?
  keyAchievements      String?
  notableProjects      String?
  targetRoles          String?
  industriesOfInterest String?
  workPreference       String?
  currency             String?
  salaryExpectation    String?
  languagesSpoken      String?
  availability         String?
  noticePeriod         String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt
  user                 User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("user_profiles")
}

model generations {
  id                  String    @id @default(dbgenerated("(gen_random_uuid())::text"))
  user_id             String
  job_description     String
  company_name        String    @db.VarChar(255)
  hr_name             String?   @db.VarChar(255)
  custom_prompt       String?
  cover_letter        String
  cold_email          String
  job_requirements    Json?
  company_research    Json?
  user_qualifications Json?
  writing_style       Json?
  created_at          DateTime? @default(now()) @db.Timestamp(6)
  updated_at          DateTime? @default(now()) @db.Timestamp(6)
  users               User      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_user")

  @@index([created_at(sort: Desc)], map: "idx_generations_created_at")
  @@index([user_id], map: "idx_generations_user_id")
}
